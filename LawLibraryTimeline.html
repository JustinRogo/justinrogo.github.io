<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UConn Law Library Timeline</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.js"></script>
    <style>
        :root {
            --primary: #000E2F; /* UConn Navy Blue */
            --accent: #7C878E;  /* Grey */
            --highlight: #E4002B; /* Subtle hint of red if needed, or stick to blue/white */
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-light: #596a7d;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.6;
        }

        /* --- Header & Controls --- */
        header {
            background: var(--primary);
            color: white;
            padding: 5rem 1rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #E4002B, #ffffff);
        }

        header h1 {
            font-size: 3.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        header p {
            color: #bdc3c7;
            font-size: 1.3rem;
            max-width: 700px;
            margin: 0 auto;
            font-weight: 300;
        }

        .controls-sticky {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 1.25rem;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2rem;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .control-label {
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent);
        }

        /* Dropdown Style */
        select {
            padding: 0.7rem 2.5rem 0.7rem 1.2rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--primary);
            background-color: white;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23000E2F' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.8rem center;
            background-repeat: no-repeat;
            background-size: 1.2em 1.2em;
            transition: border-color 0.2s;
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Filter Buttons */
        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
        }

        .filter-btn {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-light);
            transition: all 0.2s ease;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 14, 47, 0.2);
        }

        /* --- Timeline Structure --- */
        .timeline-container {
            position: relative;
            max-width: 1000px;
            margin: 0 auto;
            padding: 5rem 1rem;
        }

        /* The central vertical line */
        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #e0e0e0;
            transform: translateX(-50%);
            z-index: 0;
            border-radius: 2px;
        }

        .timeline-year-marker {
            position: relative;
            z-index: 10;
            text-align: center;
            margin: 6rem 0 4rem 0;
            scroll-margin-top: 180px;
        }

        .timeline-year-marker span {
            background: var(--primary);
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.6rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            letter-spacing: 0.05em;
            border: 4px solid white;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 3rem;
            width: 100%;
            display: flex;
            justify-content: center;
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.8s cubic-bezier(0.165, 0.84, 0.44, 1), transform 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .timeline-item.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Left vs Right Alignment Logic */
        .timeline-item.left { padding-right: 50%; justify-content: flex-end; }
        .timeline-item.right { padding-left: 50%; justify-content: flex-start; }

        .timeline-item.left .timeline-content { margin-right: 4rem; text-align: right; }
        .timeline-item.right .timeline-content { margin-left: 4rem; text-align: left; }
        
        .timeline-item.left .timeline-content .timeline-header { justify-content: flex-end; }
        .timeline-item.right .timeline-content .timeline-header { justify-content: flex-start; }

        /* The Dot on the line */
        .timeline-dot {
            position: absolute;
            left: 50%;
            top: 24px;
            width: 20px;
            height: 20px;
            background: white;
            border: 5px solid var(--primary);
            border-radius: 50%;
            transform: translateX(-50%);
            z-index: 5;
            transition: all 0.3s ease;
            box-shadow: 0 0 0 4px var(--bg-color); 
        }
        
        .timeline-item:hover .timeline-dot {
            background: var(--primary);
            transform: translateX(-50%) scale(1.3);
            box-shadow: 0 0 0 6px white, 0 0 0 10px rgba(0, 14, 47, 0.1);
        }

        /* Content Card */
        .timeline-content {
            background: var(--card-bg);
            padding: 2.5rem;
            border-radius: 16px;
            box-shadow: 0 15px 40px -10px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 480px;
            border-top: 6px solid var(--primary);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        /* Triangle indicator */
        .timeline-content::after {
            content: '';
            position: absolute;
            top: 28px;
            width: 0; 
            height: 0; 
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent; 
        }

        .timeline-item.left .timeline-content::after {
            right: -10px;
            border-left: 10px solid var(--card-bg); /* Point right */
        }
        .timeline-item.right .timeline-content::after {
            left: -10px;
            border-right: 10px solid var(--card-bg); /* Point left */
        }
        
        .timeline-item:hover .timeline-content {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.15);
        }

        .timeline-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 0.8rem;
        }

        .timeline-tag {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--primary);
            background-color: rgba(0, 14, 47, 0.08);
            padding: 4px 10px;
            border-radius: 4px;
            font-weight: 700;
        }

        .timeline-date {
            font-size: 1rem;
            color: var(--accent);
            font-weight: 500;
        }

        .timeline-content h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
            font-weight: 800;
            line-height: 1.2;
        }

        .timeline-content p {
            color: var(--text-light);
            margin-bottom: 0;
            font-size: 1rem;
            line-height: 1.7;
        }

        .timeline-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            background-color: #f0f0f0;
            display: block;
            border: 1px solid rgba(0,0,0,0.05);
        }

        /* --- Responsive Design (Mobile) --- */
        @media (max-width: 768px) {
            .timeline-container {
                padding-top: 2rem;
            }
            
            .timeline-line {
                left: 20px;
            }

            .timeline-year-marker {
                text-align: left;
                padding-left: 0;
                margin-left: 20px;
                scroll-margin-top: 250px;
            }

            .timeline-year-marker span {
                font-size: 1.2rem;
                padding: 0.5rem 1.5rem;
            }

            .timeline-item.left, .timeline-item.right {
                padding: 0;
                justify-content: flex-start;
                padding-left: 55px;
            }

            .timeline-item.left .timeline-content, 
            .timeline-item.right .timeline-content {
                margin: 0;
                text-align: left;
                width: 100%;
                max-width: 100%;
            }
            
            .timeline-item.left .timeline-content::after,
            .timeline-item.right .timeline-content::after {
                left: -10px;
                right: auto;
                border-right: 10px solid var(--card-bg);
                border-left: none;
            }
            
            .timeline-item.left .timeline-content .timeline-header {
                justify-content: flex-start;
            }

            .timeline-dot {
                left: 20px;
                width: 16px;
                height: 16px;
                border-width: 4px;
            }

            .controls-sticky {
                flex-direction: column;
                align-items: stretch;
                gap: 1rem;
                padding: 1rem;
            }
            
            .control-group {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .filter-buttons {
                width: 100%;
                overflow-x: auto;
                padding-bottom: 10px;
                flex-wrap: nowrap;
                -webkit-overflow-scrolling: touch;
            }
            
            .filter-btn {
                white-space: nowrap;
                flex-shrink: 0;
            }

            header h1 {
                font-size: 2.2rem;
            }
        }
        
        #no-results {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
            display: none;
        }
    </style>
</head>
<body>

    <header>
        <h1>History of the Law Library</h1>
        <p>Innovation, Growth, and Service to the Legal Community Since 1926</p>
    </header>

    <!-- Navigation & Filters -->
    <div class="controls-sticky">
        <div class="control-group">
            <span class="control-label">Jump to Year</span>
            <select id="year-select">
                <option value="">Select a Year...</option>
                <!-- Populated by JS -->
            </select>
        </div>

        <div class="control-group">
            <span class="control-label">Filter by Theme</span>
            <div class="filter-buttons" id="theme-filters">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <div class="timeline-container" id="timeline-root">
        <div class="timeline-line"></div>
        <!-- Timeline items will be injected here -->
    </div>
    
    <div id="no-results">
        <h3>No events found for this selection.</h3>
        <p>Try selecting a different theme or viewing all events.</p>
    </div>

    <script>
        /* * COMPLETE DATASET */
        const timelineData = [
            // 1920s
            { 
                id: 1, 
                year: 1921, 
                theme: "Institutional", 
                title: "College Founded", 
                description: "The Hartford College of Law is founded by George W. Lillard as an evening school for those in the insurance industry needing legal knowledge.", 
                image: "https://images.unsplash.com/photo-1628157797746-13d43c2b87f4?auto=format&fit=crop&q=80&w=800"
            },
            { 
                id: 2, 
                year: 1922, 
                theme: "Library", 
                title: "Early Resources", 
                description: "The Law Library does not yet exist. The school utilizes the Supreme Court's State Law Library and Hartford County Bar Library for resources."
            },
            { 
                id: 3, 
                year: 1922, 
                theme: "Academic", 
                title: "First Catalog Issued", 
                description: "The first school catalog is issued, officially mentioning the reliance on external libraries for legal research."
            },
            { 
                id: 4, 
                year: 1924, 
                theme: "Academic", 
                title: "First Graduates", 
                description: "The inaugural class, consisting of six men and one woman, graduates from the College."
            },
            { 
                id: 5, 
                year: 1926, 
                theme: "Campus", 
                title: "Move to Chapel Street", 
                description: "The school moves to 51 Chapel Street in Hartford. A small library is finally established within the school.",
                image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/51_Chapel_Street_cropped.jpg"
            },
            { 
                id: 6, 
                year: 1926, 
                theme: "Library", 
                title: "First Law Book Course", 
                description: "Gladys Judd Day, the Hartford County Bar Library's librarian, offers a special course in law books and their use."
            },
            { 
                id: 7, 
                year: 1929, 
                theme: "Library", 
                title: "2,000 Volumes", 
                description: "The law school advertises its own growing collection of about 2,000 volumes, marking the start of a serious internal library."
            },
            { 
                id: 8, 
                year: 1930, 
                theme: "Library", 
                title: "Rapid Growth", 
                description: "The collection is announced to grow to approximately 7,000 volumes by the fall semester."
            },
            { 
                id: 9, 
                year: 1931, 
                theme: "Campus", 
                title: "Move to Niles Street", 
                description: "The College of Law moves to 44 Niles Street. Efforts begin to meet the American Bar Association's (ABA) library standards.",
                image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/44_Niles_Street_with_arch_etching_blacked_out_005.365.jpg"
            },

            // 1930s-1940s
            { 
                id: 10, 
                year: 1933, 
                theme: "Institutional", 
                title: "ABA Accreditation", 
                description: "The School receives approval from the American Bar Association (ABA), a major milestone for its academic standing."
                
            },
            { 
                id: 11, 
                year: 1937, 
                theme: "Institutional", 
                title: "AALS Membership", 
                description: "The School becomes a member of the Association of American Law Schools (AALS)."
            },
              { 
                id: 11.1, 
                year: 1937, 
                theme: "People", 
                title: "Lillard Appointed", 
                description: "Mrs. Caroline Lillard, one of the founders of the law school, was recommended for the position of Librarian of the College.",
                image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTrR9RfROISYnDMqvwG1ni2muq6oZ90rlxuHA&s"
            },
            { 
                id: 12, 
                year: 1940, 
                theme: "Campus", 
                title: "Move to Woodland Street", 
                description: "The School buys 39 Woodland Street, known as Jacobus Hall, to serve as its new campus.",
                image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/39_Woodland_Street_with_addition_after_1953.jpg"
            },
                 { 
                id: 12.1, 
                year: 1944, 
                theme: "People", 
                title: "Lane Appointed", 
                description: "Mrs. Margaret Taylor Lane was appointed the first professional librarian, bringing order to the library. She introduced standard library procedures and a card catalog, and began offering courses in legal bibliography."
          
            },
            { 
                id: 13, 
                year: 1948, 
                theme: "Institutional", 
                title: "UConn Affiliation", 
                description: "The School officially becomes the University of Connecticut School of Law.",
                image: "https://images.unsplash.com/photo-1541339907198-e08756dedf3f?auto=format&fit=crop&q=80&w=800"
            },

            // 1950s-1970s
            { 
                id: 14, 
                year: 1956, 
                theme: "People", 
                title: "Bysiewicz Appointed", 
                description: "Shirley Raissi Bysiewicz is appointed as the first female tenure-track professor and takes a leadership role in the library."
               
            },
            { 
                id: 15, 
                year: 1964, 
                theme: "Campus", 
                title: "Asylum Avenue Move", 
                description: "The Law School moved to its new facility in West Hartford. The library's collection was moved from the old building, and shelving space was designed for future expansion.",
                image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/197__-_1800_Asylum_bldg___students.jpg"
            },
            { 
                id: 16, 
                year: 1968, 
                theme: "Institutional", 
                title: "Austerity Measures", 
                description: "Library positions are frozen by Governor Meskill due to state-wide austerity measures, impacting staff growth."
            },
                { 
                id: 16.1, 
                year: 1969, 
                theme: "Library", 
                title: "Classification System Change", 
                description: "Law Library decides to begin using the Library of Congress (LC) classification system as soon as a new cataloger is hired.  A decision reinforced after a visit to Villanova and a study of the K classicifcation system at the Los Angeles County Bar Association Library."
            },
            { 
                id: 17, 
                year: 1971, 
                theme: "Academic", 
                title: "Women and the Law", 
                description: "A new course 'Women and the Law' is added to the curriculum, taught by Professor Bysiewicz."
            },
            { 
                id: 18, 
                year: 1972, 
                theme: "People", 
                title: "Judy Lahey Resigns", 
                description: "Judy Lahey resigns as Assistant Law Librarian. Her thesis was on the history of the UConn Law Library."
            },
            { 
                id: 19, 
                year: 1974, 
                theme: "Library", 
                title: "Seating Expansion", 
                description: "The Dean looks to the Library to expand seating capacity via Commission for Higher Education funding."
            },
            { 
                id: 20, 
                year: 1978, 
                theme: "Campus", 
                title: "Seminary Purchase", 
                description: "The State of Connecticut purchases the Hartford Seminary campus for use by the Law School."
            },

            // 1980s-1990s
            { 
                id: 21, 
                year: 1983, 
                theme: "Library", 
                title: "Staffing Pressures", 
                description: "Staffing issues continue as the library faces pressures to meet growing needs. Staff increases to 12 FTE."
            },
            { 
                id: 22, 
                year: 1983, 
                theme: "People", 
                title: "Bysiewicz Tenure Ends", 
                description: "Professor Bysiewicz's tenure ends, having overseen the collection's growth to 85,000 volumes."
            },
            { 
                id: 23, 
                year: 1984, 
                theme: "Campus", 
                title: "The Gothic Campus", 
                description: "The Law School moves into the historic Gothic-style buildings on the new campus.",
               image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/Starr_Hall_landscape.jpg"
            },
            { 
                id: 24, 
                year: 1984, 
                theme: "People", 
                title: "Stone Appointed", 
                description: "Dennis Stone is appointed Director, marking a new era in library leadership."
            },
            { 
                id: 25, 
                year: 1990, 
                theme: "Institutional", 
                title: "Library Autonomy", 
                description: "As of September 1, the Library becomes autonomous under the Law School, shifting from shared University governance."
            },
            { 
                id: 26, 
                year: 1990, 
                theme: "Campus", 
                title: "Architect Chosen", 
                description: "An architect is chosen for the New Library, setting the stage for the modern campus facility."
            },
            { 
                id: 27, 
                year: 1996, 
                theme: "Campus", 
                title: "New Library Opens", 
                description: "The new Law Library building officially opens its doors to students and faculty.",
                image: "https://d2jv02qf7xgjwx.cloudfront.net/accounts/321838/images/GrayLibrary.JPG"
            },
            { 
                id: 28, 
                year: 1996, 
                theme: "Campus", 
                title: "Dedication Ceremony", 
                description: "The current law library building at 39 Elizabeth St. is dedicated on September 9, 1996."
            },
            { 
                id: 29, 
                year: 1996, 
                theme: "People", 
                title: "Kirk Appointed", 
                description: "Darcy Kirk is appointed as Law Librarian."
            },

            // 2000s+
            { 
                id: 30, 
                year: 2007, 
                theme: "Student Life", 
                title: "Pro Se Established", 
                description: "'Pro Se' student newspaper is founded in response to controversies surrounding an SBA event."
            },
            { 
                id: 31, 
                year: 2010, 
                theme: "Campus", 
                title: "Meskill Dedication", 
                description: "The law library is officially dedicated to the late Governor Thomas J. Meskill."
            },
               { 
                id: 32, 
                year: 2018, 
                theme: "People", 
                title: "de Perio Wittman Selected", 
                description: "Jessica de Perio Wittman is selected as Director of the Law Library.",
                image:"https://law.media.uconn.edu/wp-content/uploads/sites/3082/2021/07/deperio-wittman.jpg"
            },
            { 
                id: 33, 
                year: 2021, 
                theme: "Institutional", 
                title: "Library MOU", 
                description: "A Memorandum of Understanding (MOU) is developed between the UConn libraries, solidifying collaboration.",
                image: "https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&q=80&w=800"
            }
        ];

        /*
         * RENDER LOGIC
         */
        const timelineRoot = document.getElementById('timeline-root');
        const yearSelect = document.getElementById('year-select');
        const themeFilterContainer = document.getElementById('theme-filters');
        const noResults = document.getElementById('no-results');
        
        // 1. Extract Unique Themes & Years
        const themes = [...new Set(timelineData.map(item => item.theme))].sort();
        const years = [...new Set(timelineData.map(item => item.year))].sort((a,b) => a - b);

        // 2. Initialize Controls
        function initControls() {
            // Clear container
            themeFilterContainer.innerHTML = '';

            // A. Create "All Themes" button explicitly to ensure event listener is attached
            const allBtn = document.createElement('button');
            allBtn.className = 'filter-btn active';
            allBtn.textContent = 'All Themes';
            allBtn.dataset.theme = 'all';
            allBtn.onclick = () => filterByTheme('all', allBtn);
            themeFilterContainer.appendChild(allBtn);

            // B. Create Theme Buttons
            themes.forEach(theme => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn';
                btn.textContent = theme;
                btn.dataset.theme = theme;
                btn.onclick = () => filterByTheme(theme, btn);
                themeFilterContainer.appendChild(btn);
            });

            // C. Populate Year Dropdown
            yearSelect.innerHTML = '<option value="">Jump to Year...</option>';
            years.forEach(year => {
                const opt = document.createElement('option');
                opt.value = year;
                opt.textContent = year;
                yearSelect.appendChild(opt);
            });

            yearSelect.addEventListener('change', (e) => {
                const targetYear = e.target.value;
                if(targetYear) jumpToYear(targetYear);
            });
        }

        // 3. Render Timeline
        function renderTimeline(filterTheme = 'all') {
            // Clear current content (except the line)
            timelineRoot.innerHTML = '<div class="timeline-line"></div>';
            
            let visibleCount = 0;
            let lastYearRendered = null;

            // Sort data by year
            const sortedData = timelineData.sort((a, b) => a.year - b.year);

            sortedData.forEach((item, index) => {
                // Filter Logic
                if (filterTheme !== 'all' && item.theme !== filterTheme) return;

                visibleCount++;

                // If year changed significantly, render header
                if (item.year !== lastYearRendered) {
                    const marker = document.createElement('div');
                    marker.className = 'timeline-year-marker';
                    marker.id = `year-${item.year}`;
                    marker.innerHTML = `<span>${item.year}</span>`;
                    timelineRoot.appendChild(marker);
                    lastYearRendered = item.year;
                }

                // Create Card
                const card = document.createElement('div');
                const side = visibleCount % 2 === 0 ? 'right' : 'left';
                
                card.className = `timeline-item ${side}`;
                card.innerHTML = `
                    <div class="timeline-dot"></div>
                    <div class="timeline-content">
                        <div class="timeline-header">
                            <span class="timeline-tag">${item.theme}</span>
                            <span class="timeline-date">${item.year}</span>
                        </div>
                        <h3>${item.title}</h3>
                        ${item.image ? `<img src="${item.image}" alt="${item.title}" class="timeline-image" loading="lazy">` : ''}
                        <p>${item.description}</p>
                    </div>
                `;

                timelineRoot.appendChild(card);
            });

            // Handle Empty State
            if (visibleCount === 0) {
                noResults.style.display = 'block';
            } else {
                noResults.style.display = 'none';
            }
            
            // Re-initialize animations
            setupObserver();
        }

        // 4. Filtering Logic
        function filterByTheme(selectedTheme, clickedBtn) {
            // Update UI Active State
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            clickedBtn.classList.add('active');

            // Re-render
            renderTimeline(selectedTheme);
        }

        // 5. Jump Logic
        function jumpToYear(year) {
            // If the year is hidden due to filters, reset filter first
            const activeFilter = document.querySelector('.filter-btn.active').dataset.theme;
            const eventExistsInFilter = timelineData.some(i => i.year == year && (activeFilter === 'all' || i.theme === activeFilter));

            if (!eventExistsInFilter) {
                // Reset to 'All'
                const allBtn = document.querySelector('[data-theme="all"]');
                allBtn.click();
                
                setTimeout(() => scrollToElement(year), 100); 
            } else {
                scrollToElement(year);
            }
        }

        function scrollToElement(year) {
            const element = document.getElementById(`year-${year}`);
            if (element) {
                // Calculate offset for sticky header
                const headerOffset = 180;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
            }
        }

        // 6. Scroll Animations
        function setupObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.1, rootMargin: "0px 0px -50px 0px" });

            document.querySelectorAll('.timeline-item').forEach(item => {
                observer.observe(item);
            });
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            initControls();
            renderTimeline();
            if(window.lucide) lucide.createIcons();
        });

    </script>
</body>
</html>